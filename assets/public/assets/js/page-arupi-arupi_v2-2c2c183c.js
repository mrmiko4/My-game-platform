import{G as $e,z as Te,r as h,R as Pe,T as Le,A as K,a8 as Ie,aL as Be,B,$ as De,aM as Ue,a7 as Ne,C as Se,aK as Ae,H as p,I as m,Q as c,av as v,J as e,aB as D,P as o,O as r,ao as _,K as Q,M as j,ap as A,V as Oe,aC as Re,aD as Ee,F as J,u as G,N as u,au as Fe,ax as Ve,aF as Me}from"./common.modules-f9fa5dc7.js";import{aj as qe,ak as We,al as Ze,am as ze,an as He,ao as Ke,ap as X,L as Y,aq as Qe,ar as je,as as ee,at as te,au as ae,av as oe,aw as Je,ax as Ge,_ as Xe}from"./page-activity-ActivityDetail-5a5f2722.js";import{a as Ye}from"./page-arupi-crypto.ts-cbaea74d.js";import"./page-turntable-assets-d6267459.js";import"./native/index-eb46cb93.js";import"./en-cfd26acf.js";const y=k=>(Re("data-v-9d88a288"),k=k(),Ee(),k),et={class:"x-order pt10 pr15 pl15"},tt={key:0},at={class:"order_info"},ot={class:"item"},st={class:"amount"},nt={class:"amount-copy"},it={key:0,class:"discount"},lt={class:"timeout"},rt={class:"x-title"},ct=y(()=>e("span",null,null,-1)),dt={class:"x-order-pay x-row x-flex-warp"},ut=["onClick"],pt={class:"x-row x-row-middle-center"},mt=["src"],vt={class:"name"},ft={class:"x-title"},ht=y(()=>e("span",null,null,-1)),_t={class:"qrcode mb8"},yt={class:"qrimg"},wt={key:0,class:"utr-copy"},Ct={class:"x-tc mt8"},gt={class:"x-tc mt8 mb16"},kt=y(()=>e("p",{class:"x-tc mt8 mb16"},"3. We support all upi",-1)),xt={class:"x-title mt8"},bt=y(()=>e("span",null,null,-1)),$t={class:"transfro_tip"},Tt={key:1,class:"x-order-food"},Pt={key:2,class:"x-row x-column x-row-middle x-tc expired"},Lt=y(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"72",height:"72",viewBox:"0 0 72 72",fill:"none"},[e("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M36 6.96774C19.9659 6.96774 6.96774 19.9659 6.96774 36C6.96774 52.0341 19.9659 65.0323 36 65.0323C52.0341 65.0323 65.0323 52.0341 65.0323 36C65.0323 19.9659 52.0341 6.96774 36 6.96774ZM0 36C0 16.1177 16.1177 0 36 0C55.8822 0 72 16.1177 72 36C72 55.8822 55.8822 72 36 72C16.1177 72 0 55.8822 0 36ZM36 40.9268L23.6834 53.2435L18.7564 48.3165L31.0731 35.9999L18.7565 23.6834L23.6835 18.7564L36 31.073L48.3165 18.7564L53.2435 23.6834L40.9269 35.9999L53.2436 48.3165L48.3166 53.2435L36 40.9268Z",fill:"var(--main-color)"})],-1)),It={class:"mt16 txt"},Bt={key:3,class:"x-row x-column x-row-middle x-tc submit-complete"},Dt=y(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"72",height:"72",viewBox:"0 0 72 72",fill:"none"},[e("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M36 6.96774C19.9659 6.96774 6.96774 19.9659 6.96774 36C6.96774 52.0341 19.9659 65.0323 36 65.0323C52.0341 65.0323 65.0323 52.0341 65.0323 36C65.0323 19.9659 52.0341 6.96774 36 6.96774ZM0 36C0 16.1177 16.1177 0 36 0C55.8822 0 72 16.1177 72 36C72 55.8822 55.8822 72 36 72C16.1177 72 0 55.8822 0 36Z",fill:"#F6B02C"}),e("path",{d:"M48.5108 48.7305L35.1348 37V16",stroke:"#F6B02C","stroke-width":"7"})],-1)),Ut={class:"weight"},Nt={class:"x-order-reason pr16 pb16 pl16 pt16"},St={class:"title mb16 x-row x-row-middle-center"},At={class:"pl25 mt10"},Ot=["placeholder"],Rt={class:"arupi"},Et={class:"title1"},Ft={class:"title2"},Vt={class:"arupi"},Mt={class:"title1"},qt={class:"title2"},Wt={class:"button"},Zt=$e({__name:"index",setup(k){const{t:U}=Te(),w=h(!1),x=Pe(),se=Le(),{handleOpen:O}=qe({type:3}),{startFun:R,stopFun:ne,pageData:E}=We(),{pageView:ie,pageLeve:le,pageClick:F}=Ze(),b=h(!1),N=h(3),C=h(),d=K({checked:-1,text:""}),g=h(!1),$=h([]),re=t=>{t.target.value&&(d.checked=-1)},ce=t=>{t>-1&&(d.text="")},V=[{name:"Paytm",icon:"icon/Paytm",id:1,url:"paytmmp://cash_wallet",desc:"Wake up support"}],T=h(""),M=Ie(""),de=Be(M,{margin:0,width:185,errorCorrectionLevel:"H",quality:1}),s=K({info:{merchantCode:"",merchantName:"",paymentExpireTime:0,amount:0,merchantOrder:"",platformOrder:"",buyOrderNo:"",sellOrderNo:"",chOrderNo:"",createTime:"",memberId:"",externalMemberId:"",returnUrl:"",orderStatus:"",upiId:"",utr:"",hideUpiCopyButton:1,randomCode:"",randomAmount:0},type:0}),ue=B(()=>s.info.utr?s.info.utr:E.info.utr),q=B(()=>!!(s.info.utr||E.info.utr)),pe=h("");De(ue,t=>{pe.value=t});const{pause:me,resume:ve}=Ue(()=>{s.info.paymentExpireTime<=0?(W(),ne(),me()):s.info.paymentExpireTime-=1},1e3,{immediate:!1,immediateCallback:!1}),fe=async()=>{const{code:t,data:a}=await ze({});t==="1"&&($.value=a)},S=B(()=>s.info.amount?s.info.amount-s.info.randomAmount:0),W=async()=>{const t=se.query.type,{code:a,data:l}=await He();if(a==="1"){s.type=t?4:0;const i=Ye(l);s.info=i,i.orderStatus==="2"?x.replace("/Payment"):i.orderStatus==="3"&&x.replace("/Fail"),await Oe(),M.value="upi://pay?pa="+i.upiId+"&am="+S.value+"&cu=INR&tn="+i.tid+"&notes="+i.tid+"&transactionDescription="+i.tid+"&tid="+i.tid+"&tr="+i.tid,ve(),R("",0),R("",1)}else s.type=1,w.value=!1};function he(){const{upiId:t,tid:a}=s.info;try{const l={contact:{type:"VPA",vpa:t,cbsName:"",nickName:""},p2pPaymentCheckoutParams:{checkoutType:"DEFAULT",disableViewHistory:!1,initialAmount:S.value*100,isByDefaultKnownContact:!1,note:a,shouldShowMaskedNumber:!1,shouldShowUnsavedContactBanner:!0,showKeyboard:!1}},i=btoa(JSON.stringify(l));Ge();const f=`phonepe://native?data=${i}&id=p2ppayment`;ee()?te(f):ae()?oe("recharge",{url:f,recharegeName:"Arupi"}):window.location.href=f}catch(l){console.error("PhonePe Deeplink 测试出错:",l)}}const Z=t=>{var l;let a=t.url;t.url.startsWith("paytmmp://cash_wallet")?(a+=`?featuretype=money_transfer&pa=${s.info.upiId}&am=${S.value}&cu=INR&tn=${((l=s.info)==null?void 0:l.tid)||""}`,F(1),ee()?te(a):ae()?oe("recharge",{url:a,recharegeName:"Arupi"}):window.location.href=a):(s.info.isPhonepeWakeUp===1&&he(),F(2))},_e=()=>{b.value=!0,clearInterval(C.value),C.value=null,N.value=3,C.value=setInterval(()=>{N.value-=1},1e3),setTimeout(()=>{clearInterval(C.value),C.value=null,b.value=!1,Z(V[0])},3e3)},P=Ne(async()=>{const t=await Ke({});t.code==="1"?(s.type=3,g.value=!1,J(U("SubmittedS")),setTimeout(()=>{L()},1e3)):G(t.msg)},3e3),ye=async()=>{var i,f;const{checked:t,text:a}=d;if(t===-1&&!a)return G(U("addCancelDes"));(await Je({reason:t>-1?(i=$.value[t])==null?void 0:i.reason:d.text,reasonId:t>-1?(f=$.value[t])==null?void 0:f.id:null})).code==="1"&&(w.value=!1,J(U("cancelSuccess")),setTimeout(()=>{x.push({name:"Recharge"})},1e3))},we=t=>{const[a,l]=t.split("@");return"*".repeat(a.length)+"@"+l},Ce=B(()=>s.info.amount<2e3?!1:s.info.hideUpiCopyButton==0);function L(){x.push({name:"Recharge"})}return Se(()=>{W(),fe(),setTimeout(()=>{ie("order")},1500)}),Ae(()=>{le("order")}),(t,a)=>{const l=p("NavBar"),i=p("svg-icon"),f=p("van-loading"),ge=p("van-image"),z=p("van-button"),ke=p("van-radio"),xe=p("van-radio-group"),be=p("van-popup"),H=p("van-dialog");return u(),m("div",et,[c(l,{title:"ArUpiPay",placeholder:!1,"left-arrow":"",onClickLeft:L},{right:v(()=>[e("div",{class:"sever x-row x-row-between x-row-middle-center",onClick:a[0]||(a[0]=(...n)=>r(O)&&r(O)(...n))},o(t.$t("customerService")),1)]),_:1}),s.type===0?(u(),m("div",tt,[e("div",at,[e("div",ot,[e("span",st,[D(o(r(X)((s.info.amount||0)-s.info.randomAmount))+" ",1),e("div",nt,[c(i,{onClick:a[1]||(a[1]=n=>r(Y)(s.info.amount)),name:"copy"})]),s.info.randomAmount&&s.info.randomAmount>0?(u(),m("div",it,o(t.$t("discountB"))+" "+o(r(X)(s.info.randomAmount||0)),1)):_("v-if",!0)]),e("div",lt,[e("span",null,o(r(Qe)(s.info.paymentExpireTime||0)),1)])])]),e("div",null,[e("div",rt,[ct,e("p",null,o(t.$t("choosePay")),1)]),e("div",dt,[(u(),m(Q,null,j(V,(n,I)=>e("div",{class:A(["item",{[n.name]:!0}]),key:I,onClick:zt=>n.name==="Paytm"?_e():Z(n)},[e("div",pt,[e("img",{class:"img",src:r(je)(n.icon,"svg")},null,8,mt),e("p",vt,o(n.name),1)]),e("p",null,o(n.desc),1)],10,ut)),64))])]),e("div",{class:A({order_active:T.value==="PhonePe"})},[e("div",null,[e("div",ft,[ht,e("p",null,o(t.$t("scanPay")),1)]),e("div",_t,[e("div",null,[e("div",yt,[c(ge,{src:r(de),class:"qrc",id:"canvasDom"},{loading:v(()=>[c(f,{type:"spinner",size:"20"})]),_:1},8,["src"])]),Ce.value?(u(),m("div",wt,[e("span",null,o(we(s.info.upiId)),1),c(i,{onClick:a[2]||(a[2]=n=>r(Y)(s.info.upiId)),name:"copy",class:"copy-icon"})])):_("v-if",!0),e("h3",Ct,"1."+o(t.$t("scanPayTip")),1),e("p",gt,"2."+o(t.$t("deviceQR"))+".",1),kt])])])],2),e("div",xt,[bt,e("p",null,o(t.$t("importantReminder"))+"：",1)]),e("div",$t,[e("p",null,"1."+o(t.$t("sameLink")),1),e("p",null,"2."+o(t.$t("paytmUp")),1)])])):_("v-if",!0),_(" 取消和提交 "),[0,4].includes(s.type)&&!q.value?(u(),m("div",Tt,[e("div",{class:"cancel",onClick:a[3]||(a[3]=()=>{if(T.value){T.value="";return}g.value=!0})},o(T.value==="Paytm"?t.$t("withdrawDialogDesc6"):t.$t("cancel")),1),e("div",{class:A(["submit",(q.value,"active")]),onClick:a[4]||(a[4]=(...n)=>r(P)&&r(P)(...n))},o(t.$t("submit")),3)])):_("v-if",!0),s.type==1?(u(),m("div",Pt,[Lt,e("p",It,o(t.$t("PaymentExpired")),1),c(z,{round:"",block:"",type:"primary",class:"x-btn btn mt40",onClick:L},{default:v(()=>[D(o(t.$t("returnMerchant")),1)]),_:1})])):_("v-if",!0),s.type==3?(u(),m("div",Bt,[Dt,e("p",Ut,o(t.$t("submitSuccessfully")),1),e("p",null,o(t.$t("untilConfirm")),1),c(z,{round:"",block:"",type:"primary",class:"x-btn btn mt40",onClick:L},{default:v(()=>[D(o(t.$t("complete")),1)]),_:1})])):_("v-if",!0),c(be,{position:"bottom",show:w.value,"onUpdate:show":a[7]||(a[7]=n=>w.value=n)},{default:v(()=>[e("div",Nt,[e("div",St,o(t.$t("cancelOrder")),1),c(xe,{"icon-size":"16px",modelValue:d.checked,"onUpdate:modelValue":a[5]||(a[5]=n=>d.checked=n),"checked-color":"#EE4D4D",onChange:ce},{default:v(()=>[(u(!0),m(Q,null,j($.value,(n,I)=>(u(),Fe(ke,{name:I,class:"item",key:I},{default:v(()=>[D(o(n.reason),1)]),_:2},1032,["name"]))),128)),_(` <van-radio name="2" class="item">UPI账号错误</van-radio>
                            <van-radio name="3" class="item">银行系统维护</van-radio>
                            <van-radio name="4" class="item">其他</van-radio> `)]),_:1},8,["modelValue"]),e("div",At,[Ve(e("textarea",{class:"row","onUpdate:modelValue":a[6]||(a[6]=n=>d.text=n),rows:"4",placeholder:t.$t("sellTip18"),onInput:re},null,40,Ot),[[Me,d.text]])]),e("div",{class:"btn x-row x-row-middle-center",onClick:ye},o(t.$t("confirmCancel")),1)])]),_:1},8,["show"]),c(H,{class:"arupi-dialog",closeOnClickOverlay:!1,show:b.value,"onUpdate:show":a[8]||(a[8]=n=>b.value=n),"show-confirm-button":!1,width:327},{default:v(()=>[e("div",Rt,[e("div",Et,o(t.$t("tips")),1),e("div",Ft,o(t.$t("safetyTip")),1),e("p",null,o(N.value)+"S",1)])]),_:1},8,["show"]),c(H,{class:"arupi-dialog",closeOnClickOverlay:!1,show:g.value,"onUpdate:show":a[11]||(a[11]=n=>g.value=n),"show-confirm-button":!1,width:327},{default:v(()=>[e("div",Vt,[e("div",Mt,o(t.$t("cancelDeal")),1),e("div",qt,o(t.$t("paymeConfirm")),1),e("div",Wt,[e("div",{class:"clance",onClick:a[9]||(a[9]=()=>{d.checked=-1,d.text="",w.value=!0,g.value=!1})},o(t.$t("confirmCancel")),1),e("div",{class:"goBuy",onClick:a[10]||(a[10]=(...n)=>r(P)&&r(P)(...n))},o(t.$t("payme")),1)])])]),_:1},8,["show"])])}}});const Xt=Xe(Zt,[["__scopeId","data-v-9d88a288"],["__file","/usr/local/jenkins-prod/workspace/AR081-Pages-Bengal-dkwin/src/views/arupi/arupi_v2/index.vue"]]);export{Xt as default};
