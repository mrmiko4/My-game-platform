import{G as Se,z as Ie,r as w,R as Le,T as Ae,A as ee,B as x,a8 as Be,aL as Ne,$ as Ve,aM as Re,a7 as Ee,C as Oe,aK as Fe,H as _,I as d,Q as c,av as v,J as e,aB as k,P as s,O as u,ao as p,K as te,M as oe,ap as E,V as Me,aC as qe,aD as We,u as O,F as ae,N as l,au as ze,ax as Ze,aF as He}from"./common.modules-f9fa5dc7.js";import{aj as Ke,ak as Qe,al as Je,am as je,an as Ge,ay as Xe,ap as N,L as F,aq as se,ar as Ye,as as ne,at as ie,au as le,av as re,ax as M,aw as et}from"./page-activity-ActivityDetail-5a5f2722.js";import{a as tt}from"./page-arupi-crypto.ts-cbaea74d.js";const g=T=>(qe("data-v-7afe3ff2"),T=T(),We(),T),ot={class:"x-order pt10 pr15 pl15"},at={key:0},st={class:"order_info"},nt={class:"item"},it={class:"amount"},lt={class:"amount-copy"},rt={key:0,class:"discount"},dt={class:"timeout"},ct={key:0},ut={class:"x-title"},pt=g(()=>e("span",null,null,-1)),mt={class:"x-order-pay x-row x-flex-warp"},vt=["onClick"],ft={class:"x-row x-row-middle-center"},ht=["src"],yt={class:"name"},_t={key:0},wt={class:"x-title"},kt=g(()=>e("span",null,null,-1)),gt={class:"qrcode mb8"},Ct={class:"qrimg"},bt={key:0,class:"utr-copy"},$t={class:"x-tc mt8"},Pt={class:"x-tc mt8 mb16"},xt={class:"x-title"},Tt=g(()=>e("span",null,null,-1)),Ut={class:"x-order-utr"},Dt={class:"box"},St={class:"x-title mt8"},It=g(()=>e("span",null,null,-1)),Lt={class:"transfro_tip"},At={key:1},Bt={class:"order_info"},Nt={class:"item"},Vt={class:"amount"},Rt={class:"amount-copy"},Et={key:0,class:"discount"},Ot={class:"timeout"},Ft={class:"x-order-utr"},Mt={class:"box"},qt={key:2,class:"x-order-food"},Wt={key:3,class:"x-row x-column x-row-middle x-tc expired"},zt=g(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"72",height:"72",viewBox:"0 0 72 72",fill:"none"},[e("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M36 6.96774C19.9659 6.96774 6.96774 19.9659 6.96774 36C6.96774 52.0341 19.9659 65.0323 36 65.0323C52.0341 65.0323 65.0323 52.0341 65.0323 36C65.0323 19.9659 52.0341 6.96774 36 6.96774ZM0 36C0 16.1177 16.1177 0 36 0C55.8822 0 72 16.1177 72 36C72 55.8822 55.8822 72 36 72C16.1177 72 0 55.8822 0 36ZM36 40.9268L23.6834 53.2435L18.7564 48.3165L31.0731 35.9999L18.7565 23.6834L23.6835 18.7564L36 31.073L48.3165 18.7564L53.2435 23.6834L40.9269 35.9999L53.2436 48.3165L48.3166 53.2435L36 40.9268Z",fill:"var(--main-color)"})],-1)),Zt={class:"mt16 txt"},Ht={key:4,class:"x-row x-column x-row-middle x-tc submit-complete"},Kt=g(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"72",height:"72",viewBox:"0 0 72 72",fill:"none"},[e("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M36 6.96774C19.9659 6.96774 6.96774 19.9659 6.96774 36C6.96774 52.0341 19.9659 65.0323 36 65.0323C52.0341 65.0323 65.0323 52.0341 65.0323 36C65.0323 19.9659 52.0341 6.96774 36 6.96774ZM0 36C0 16.1177 16.1177 0 36 0C55.8822 0 72 16.1177 72 36C72 55.8822 55.8822 72 36 72C16.1177 72 0 55.8822 0 36Z",fill:"#F6B02C"}),e("path",{d:"M48.5108 48.7305L35.1348 37V16",stroke:"#F6B02C","stroke-width":"7"})],-1)),Qt={class:"weight"},Jt={class:"x-order-reason pr16 pb16 pl16 pt16"},jt={class:"title mb16 x-row x-row-middle-center"},Gt={class:"pl25 mt10"},Xt=["placeholder"],Yt={class:"arupi"},eo={class:"title1"},to={class:"title2"},oo={class:"arupi"},ao={class:"title1"},so={class:"title2"},no={class:"button"},uo=Se({__name:"index",setup(T){const{t:U}=Ie(),C=w(!1),D=Le(),de=Ae(),{handleOpen:q}=Ke({type:3}),{startFun:W,stopFun:ce,pageData:z}=Qe(),{pageView:ue,pageLeve:pe,pageClick:Z}=Je(),S=w(!1),V=w(3),b=w(),h=ee({checked:-1,text:""}),$=w(!1),I=w([]),me=t=>{t.target.value&&(h.checked=-1)},ve=t=>{t>-1&&(h.text="")},H=async()=>{var t,o,r,i;if(navigator.clipboard&&navigator.clipboard.readText)try{const f=await navigator.clipboard.readText();m.value=f||""}catch{m.value=((o=(t=document==null?void 0:document.getSelection)==null?void 0:t.call(document))==null?void 0:o.toString())??""}else m.value=((i=(r=document==null?void 0:document.getSelection)==null?void 0:r.call(document))==null?void 0:i.toString())??""},K=x(()=>[{name:"Paytm",icon:"icon/Paytm",id:1,url:"paytmmp://cash_wallet",desc:"Wake up support"},{name:"PhonePe",icon:"icon/PhonePe",id:2,url:"phonepe://pay",desc:a.info.isPhonepeWakeUp===1?"Wake up support":"Pay for oneself"}]),y=w(),Q=Be(""),fe=Ne(Q,{margin:0,width:145,errorCorrectionLevel:"H",quality:1}),a=ee({info:{merchantCode:"",merchantName:"",paymentExpireTime:0,amount:0,merchantOrder:"",platformOrder:"",buyOrderNo:"",sellOrderNo:"",chOrderNo:"",createTime:"",memberId:"",externalMemberId:"",returnUrl:"",orderStatus:"",upiId:"",utr:"",hideUpiCopyButton:1,randomCode:"",isPhonepeWakeUp:0,randomAmount:0},type:0}),he=x(()=>a.info.utr?a.info.utr:z.info.utr),P=x(()=>!!(a.info.utr||z.info.utr)),m=w("");Ve(he,t=>{m.value=t});const{pause:ye,resume:_e}=Re(()=>{a.info.paymentExpireTime<=0?(J(),ce(),ye()):a.info.paymentExpireTime-=1},1e3,{immediate:!1,immediateCallback:!1}),we=async()=>{const{code:t,data:o}=await je({});t==="1"&&(I.value=o)},R=x(()=>a.info.amount?a.info.amount-a.info.randomAmount:0),J=async()=>{const t=de.query.type,{code:o,data:r}=await Ge();if(o==="1"){a.type=t?4:0;const i=tt(r);a.info=i,console.log("Decrypted payment details:",i),i.orderStatus==="2"?D.replace("/Payment"):i.orderStatus==="3"&&D.replace("/Fail"),await Me(),Q.value="upi://pay?pa="+i.upiId+"&am="+R.value+"&cu=INR&tn="+i.tid+"&notes="+i.tid+"&transactionDescription="+i.tid+"&tid="+i.tid+"&tr="+i.tid,_e(),W("",0),W("",1)}else a.type=1,C.value=!1},ke=()=>{a.type=4,$.value=!1};function ge(){const{upiId:t,tid:o}=a.info;try{const r={contact:{type:"VPA",vpa:t,cbsName:"",nickName:""},p2pPaymentCheckoutParams:{checkoutType:"DEFAULT",disableViewHistory:!1,initialAmount:R.value*100,isByDefaultKnownContact:!1,note:o,shouldShowMaskedNumber:!1,shouldShowUnsavedContactBanner:!0,showKeyboard:!1}},i=btoa(JSON.stringify(r));M({bankCode:"phonepe"});const f=`phonepe://native?data=${i}&id=p2ppayment`;console.log("Attempting to open PhonePe Deeplink for ₹"+f),ne()?ie(f):le()?re("recharge",{url:f,recharegeName:"Arupi"}):window.location.href=f}catch(r){console.error("PhonePe Deeplink 测试出错:",r)}}const j=t=>{var r;let o=t.url;y.value=t.name,t.url.startsWith("paytmmp://cash_wallet")?(o+=`?featuretype=money_transfer&pa=${a.info.upiId}&am=${R.value}&cu=INR&tn=${((r=a.info)==null?void 0:r.tid)||""}`,ne()?ie(o):le()?re("recharge",{url:o,recharegeName:"Arupi"}):window.open(o,"_blank"),M({bankCode:"paytm"}),Z(1)):a.info.isPhonepeWakeUp===1&&(ge(),M({bankCode:"phonepe"}),Z(2))},Ce=()=>{S.value=!0,clearInterval(b.value),b.value=null,V.value=3,b.value=setInterval(()=>{V.value-=1},1e3),setTimeout(()=>{clearInterval(b.value),b.value=null,S.value=!1,j(K.value[0])},3e3)},G=Ee(async()=>{if(P.value)return;if(!m.value||m.value.length<12)return O(U("formatIncorrect"));const t=await Xe({utr:m.value});t.code==="1"?(a.type=3,ae(U("SubmittedS")),setTimeout(()=>{L()},1e3)):O(t.msg)},3e3),be=async()=>{var i,f;const{checked:t,text:o}=h;if(t===-1&&!o)return O(U("addCancelDes"));(await et({reason:t>-1?(i=I.value[t])==null?void 0:i.reason:h.text,reasonId:t>-1?(f=I.value[t])==null?void 0:f.id:null})).code==="1"&&(C.value=!1,ae(U("cancelSuccess")),setTimeout(()=>{D.push({name:"Recharge"})},1e3))},$e=t=>{const[o,r]=t.split("@");return"*".repeat(o.length)+"@"+r},Pe=x(()=>a.info.amount<2e3?!1:a.info.hideUpiCopyButton==0);function L(){D.push({name:"Recharge"})}return Oe(()=>{J(),we(),setTimeout(()=>{ue("order")},1500)}),Fe(()=>{pe("order")}),(t,o)=>{const r=_("NavBar"),i=_("svg-icon"),f=_("van-loading"),xe=_("van-image"),A=_("van-button"),X=_("van-field"),Te=_("van-radio"),Ue=_("van-radio-group"),De=_("van-popup"),Y=_("van-dialog");return l(),d("div",ot,[c(r,{title:"ArUpiPay",placeholder:!1,"left-arrow":"",onClickLeft:L},{right:v(()=>[e("div",{class:"sever x-row x-row-between x-row-middle-center",onClick:o[0]||(o[0]=(...n)=>u(q)&&u(q)(...n))},s(t.$t("customerService")),1)]),_:1}),a.type===0?(l(),d("div",at,[e("div",st,[e("div",nt,[e("span",it,[k(s(u(N)((a.info.amount||0)-a.info.randomAmount))+" ",1),e("div",lt,[c(i,{onClick:o[1]||(o[1]=n=>u(F)(a.info.amount)),name:"copy"})]),a.info.randomAmount&&a.info.randomAmount>0?(l(),d("div",rt,s(t.$t("discountB"))+" "+s(u(N)(a.info.randomAmount||0)),1)):p("v-if",!0)]),e("div",dt,[e("span",null,s(u(se)(a.info.paymentExpireTime||0)),1)])])]),y.value!=="Paytm"?(l(),d("div",ct,[e("div",ut,[pt,e("p",null,s(t.$t("choosePay")),1)]),e("div",mt,[(l(!0),d(te,null,oe(K.value,(n,B)=>(l(),d("div",{class:E(["item",{active:y.value===n.name,[n.name]:!0}]),key:B,onClick:io=>n.name==="Paytm"?Ce():j(n)},[e("div",ft,[e("img",{class:"img",src:u(Ye)(n.icon,"svg")},null,8,ht),e("p",yt,s(n.name),1)]),e("p",null,s(n.desc),1)],10,vt))),128))])])):p("v-if",!0),e("div",{class:E({order_active:y.value==="PhonePe"})},[y.value!=="Paytm"?(l(),d("div",_t,[e("div",wt,[kt,e("p",null,s(t.$t("scanPay")),1)]),e("div",gt,[e("div",null,[e("div",Ct,[c(xe,{src:u(fe),class:"qrc",id:"canvasDom"},{loading:v(()=>[c(f,{type:"spinner",size:"20"})]),_:1},8,["src"])]),Pe.value?(l(),d("div",bt,[e("span",null,s($e(a.info.upiId)),1),c(i,{onClick:o[2]||(o[2]=n=>u(F)(a.info.upiId)),name:"copy",class:"copy-icon"})])):p("v-if",!0),e("h3",$t,"1."+s(t.$t("scanPayTip")),1),e("p",Pt," 2."+s(t.$t("deviceQR"))+". ",1)])]),e("div",xt,[Tt,e("p",null,s(t.$t("inputUTR")),1)])])):p("v-if",!0),e("div",Ut,[e("p",null,s(t.$t("fillUTR"))+".",1),e("div",Dt,[c(X,{modelValue:m.value,"onUpdate:modelValue":o[3]||(o[3]=n=>m.value=n),maxlength:12,disabled:!!P.value,type:"digit",autocomplete:"new-password",placeholder:t.$t("inputDigits"),class:"inp"},{button:v(()=>[c(A,{size:"small",type:"primary",onClick:H},{default:v(()=>[k(s(t.$t("paste")),1)]),_:1})]),_:1},8,["modelValue","disabled","placeholder"]),p(' <div class="copy" @click="submit">Submit</div> ')])])],2),e("div",St,[It,e("p",null,s(t.$t("importantReminder"))+"：",1)]),e("div",Lt,[e("p",null,"1."+s(t.$t("sameLink")),1),e("p",null,"2."+s(t.$t("paytmUp")),1)])])):p("v-if",!0),a.type===4?(l(),d("div",At,[e("div",Bt,[e("div",Nt,[e("span",Vt,[k(s(u(N)((a.info.amount||0)-a.info.randomAmount))+" ",1),e("div",Rt,[c(i,{onClick:o[4]||(o[4]=n=>u(F)(a.info.amount)),name:"copy"})]),a.info.randomAmount&&a.info.randomAmount>0?(l(),d("div",Et,s(t.$t("discountB"))+" "+s(u(N)(a.info.randomAmount||0)),1)):p("v-if",!0)]),e("div",Ot,[e("span",null,s(u(se)(a.info.paymentExpireTime||0)),1)])])]),e("div",Ft,[e("p",null,s(t.$t("fillUTR"))+".",1),e("div",Mt,[c(X,{modelValue:m.value,"onUpdate:modelValue":o[5]||(o[5]=n=>m.value=n),maxlength:12,disabled:!!P.value,type:"digit",autocomplete:"new-password",placeholder:t.$t("inputDigits"),class:"inp"},{button:v(()=>[c(A,{size:"small",type:"primary",onClick:H},{default:v(()=>[k(s(t.$t("paste")),1)]),_:1})]),_:1},8,["modelValue","disabled","placeholder"]),p(' <div class="copy" @click="submit">Submit</div> ')])])])):p("v-if",!0),p(" 取消和提交 "),[0,4].includes(a.type)&&!P.value?(l(),d("div",qt,[a.type==0?(l(),d("div",{key:0,class:"cancel",onClick:o[6]||(o[6]=()=>{if(y.value){y.value="";return}$.value=!0})},s(y.value==="Paytm"?t.$t("withdrawDialogDesc6"):t.$t("cancel")),1)):(l(),d("div",{key:1,class:"cancel",onClick:o[7]||(o[7]=()=>{if(a.type==4&&(a.type=0,t.reruen),y.value){y.value="";return}})},s(a.type==4?t.$t("withdrawDialogDesc6"):t.$t("cancel")),1)),e("div",{class:E(["submit",P.value||m.value?"active":""]),onClick:o[8]||(o[8]=(...n)=>u(G)&&u(G)(...n))},s(t.$t("submit"))+" "+s(m.value?"":t.$t("unSubmitUtr")),3)])):p("v-if",!0),a.type==1?(l(),d("div",Wt,[zt,e("p",Zt,s(t.$t("PaymentExpired")),1),c(A,{round:"",block:"",type:"primary",class:"x-btn btn mt40",onClick:L},{default:v(()=>[k(s(t.$t("returnMerchant")),1)]),_:1})])):p("v-if",!0),a.type==3?(l(),d("div",Ht,[Kt,e("p",Qt,s(t.$t("submitSuccessfully")),1),e("p",null,s(t.$t("untilConfirm")),1),c(A,{round:"",block:"",type:"primary",class:"x-btn btn mt40",onClick:L},{default:v(()=>[k(s(t.$t("complete")),1)]),_:1})])):p("v-if",!0),c(De,{position:"bottom",show:C.value,"onUpdate:show":o[11]||(o[11]=n=>C.value=n)},{default:v(()=>[e("div",Jt,[e("div",jt,s(t.$t("cancelOrder")),1),c(Ue,{"icon-size":"16px",modelValue:h.checked,"onUpdate:modelValue":o[9]||(o[9]=n=>h.checked=n),"checked-color":"#EE4D4D",onChange:ve},{default:v(()=>[(l(!0),d(te,null,oe(I.value,(n,B)=>(l(),ze(Te,{name:B,class:"item",key:B},{default:v(()=>[k(s(n.reason),1)]),_:2},1032,["name"]))),128)),p(` <van-radio name="2" class="item">UPI账号错误</van-radio>
                            <van-radio name="3" class="item">银行系统维护</van-radio>
                            <van-radio name="4" class="item">其他</van-radio> `)]),_:1},8,["modelValue"]),e("div",Gt,[Ze(e("textarea",{class:"row","onUpdate:modelValue":o[10]||(o[10]=n=>h.text=n),rows:"4",placeholder:t.$t("sellTip18"),onInput:me},null,40,Xt),[[He,h.text]])]),e("div",{class:"btn x-row x-row-middle-center",onClick:be},s(t.$t("confirmCancel")),1)])]),_:1},8,["show"]),c(Y,{class:"arupi-dialog",closeOnClickOverlay:!1,show:S.value,"onUpdate:show":o[12]||(o[12]=n=>S.value=n),"show-confirm-button":!1,width:327},{default:v(()=>[e("div",Yt,[e("div",eo,s(t.$t("tips")),1),e("div",to,s(t.$t("safetyTip")),1),e("p",null,s(V.value)+"S",1)])]),_:1},8,["show"]),c(Y,{class:"arupi-dialog",closeOnClickOverlay:!1,show:$.value,"onUpdate:show":o[15]||(o[15]=n=>$.value=n),"show-confirm-button":!1,width:327},{default:v(()=>[e("div",oo,[e("div",ao,s(t.$t("cancelDeal")),1),e("div",so,s(t.$t("paymeConfirm")),1),e("div",no,[e("div",{class:"clance",onClick:o[13]||(o[13]=()=>{h.checked=-1,h.text="",C.value=!0,$.value=!1})},s(t.$t("confirmCancel")),1),e("div",{class:"goBuy",onClick:o[14]||(o[14]=n=>ke())},s(t.$t("payme")),1)])])]),_:1},8,["show"])])}}});export{uo as _};
